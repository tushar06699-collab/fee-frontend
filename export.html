<!DOCTYPE html>
<html lang="en">
<head>
<title>Export Data ‚Äì School ERP</title>

<style>
body{
    font-family:Poppins, sans-serif;
    background:#eef1f5;
    margin:0;
    padding:40px 20px;
}

.topbar{
    display:flex;
    align-items:center;
    gap:12px;
    margin-bottom:30px;
}

.home-btn{
    background:#6c63ff;
    color:#fff;
    padding:10px 18px;
    border-radius:8px;
    font-size:15px;
    cursor:pointer;
    text-decoration:none;
    font-weight:600;
    box-shadow:0 3px 10px rgba(0,0,0,.15);
    transition:0.3s;
}
.home-btn:hover{
    background:#584fee;
}

.card{
    background:#fff;
    padding:35px;
    border-radius:18px;
    box-shadow:0 6px 18px rgba(0,0,0,.12);
    max-width:480px;
    margin:auto;
    text-align:center;
    animation:fadeIn .5s ease-in-out;
}

@keyframes fadeIn{
    from{opacity:0;transform:translateY(15px);}
    to{opacity:1;transform:translateY(0);}
}

h2{
    margin-top:0;
    color:#333;
    font-size:26px;
}

p{
    color:#666;
    font-size:15px;
    margin-bottom:25px;
}

.btn{
    padding:14px 20px;
    border:none;
    border-radius:10px;
    font-size:16px;
    font-weight:600;
    cursor:pointer;
    width:100%;
    margin-bottom:15px;
    transition:0.3s;
}

.excel{
    background:#007bff;
    color:#fff;
}
.excel:hover{
    background:#005ecb;
}

.google{
    background:#34A853;
    color:#fff;
}
.google:hover{
    background:#1f7f3e;
}
</style>
</head>

<body>

<div class="topbar">
    <a href="dashboard.html" class="home-btn">üè† Home</a>
</div>

<div class="card">
    <h2>üì§ Export School Data</h2>
    <p>Export all student records, fee details, and receipts in your preferred format.</p>

    <button class="btn excel" onclick="exportExcel()">‚¨á Export to Excel</button>
</div>

<script>
const API = "https://fee-backend-ntas.onrender.com";
let session = localStorage.getItem("session") || "2024_25";

async function exportExcel(){
    const url = `${API}/export/excel?session=${session}`;
    const res = await fetch(url, { headers:{ "X-Session": session } });
    const blob = await res.blob();

    const a = document.createElement("a");
    a.href = window.URL.createObjectURL(blob);
    a.download = `SchoolData_${session}.xlsx`;
    a.click();
}

async function exportGoogle(){
    const url = `${API}/export/google-sheet?session=${session}`;
    const res = await fetch(url);
    const data = await res.json();

    if(data.success){
        window.open(data.url, "_blank");
    } else {
        alert("Google export failed.");
    }
}
</script>

</body>
</html>
